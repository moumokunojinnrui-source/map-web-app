<!DOCTYPE html>
<html lang="ja">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-HYMKDJDV6R"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-HYMKDJDV6R');
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MapMemo - 歴史のアーカイブ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        html, body { height: 100%; margin: 0; padding: 0; overflow: hidden; font-family: sans-serif; }
        .map-wrapper { flex-grow: 1; position: relative; width: 100%; }
        iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0; }
    </style>
</head>
<body class="bg-gray-50 h-full flex flex-col">

<header class="flex-none bg-white shadow-sm p-4 flex justify-between items-center z-20">
    <div>
        <h1 class="text-xl font-bold text-slate-800 leading-none">MapMemo</h1>
        <p class="text-[10px] text-slate-500 mt-1 uppercase tracking-widest">Digital History Archive</p>
    </div>

    <div class="flex gap-2" id="mapControls">
        <button data-type="street"
            class="map-btn px-4 py-1.5 text-xs rounded-full transition-colors duration-200 font-medium border shadow-sm">
            店舗名
        </button>
        <button data-type="mall"
            class="map-btn px-4 py-1.5 text-xs rounded-full transition-colors duration-200 font-medium border shadow-sm">
            モール
        </button>
    </div>
</header>

<main class="map-wrapper">
    <iframe id="mapFrame" allowfullscreen allow="geolocation"></iframe>

    <a href="https://note.com" target="_blank"
       class="absolute bottom-6 right-6 z-30 bg-rose-500 text-white p-4 rounded-full shadow-lg hover:bg-rose-600 transition-transform hover:scale-105 flex items-center justify-center group">
        <span class="max-w-0 overflow-hidden group-hover:max-w-xs group-hover:mr-2 transition-all duration-300 ease-in-out whitespace-nowrap">
            思い出を語る
        </span>
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
        </svg>
    </a>
</main>

<footer class="flex-none bg-slate-800 text-white p-4 z-20">
    <div class="max-w-md mx-auto flex items-center justify-between">
        <div class="text-xs">
            <p class="font-bold opacity-80 uppercase tracking-tighter">Current Archive</p>
            <p id="archiveLabel" class="text-slate-300"></p>
        </div>
    </div>
</footer>

<script>
/**
 * 1. 設定の一元管理 (Constants)
 */
const MAP_CONFIG = {
    street: {
        // 東京駅を中心に表示するための座標パラメータを追加しました
        url: "https://umap.openstreetmap.fr/ja/map/mapmemo_alpha_1336908?scaleControl=false&miniMap=false&scrollWheelZoom=true&zoomControl=true&editMode=disabled&moreControl=false&searchControl=null&tilelayersControl=true&embedControl=null&datalayersControl=true&onLoadPanel=none&captionBar=false&captionMenus=false#16/35.6812/139.7671",
        label: "商店街の記憶（1950s - 2020s）"
    },
    mall: {
        url: "https://umap.openstreetmap.fr/ja/map/mapmemo_mall_1337404?scaleControl=false&miniMap=false&scrollWheelZoom=true&zoomControl=true&editMode=disabled&moreControl=true&searchControl=null&tilelayersControl=null&embedControl=null&datalayersControl=true&onLoadPanel=none&captionBar=false&captionMenus=true",
        label: "ショッピングモールの記憶（1970s - 現在）"
    }
};

const STYLES = {
    active: ["bg-slate-800", "text-white", "border-slate-800"],
    inactive: ["bg-white", "text-slate-600", "border-gray-200", "hover:bg-gray-50"]
};

/**
 * 2. 分離と機能の実行 (Logic)
 */
const elements = {
    iframe: document.getElementById("mapFrame"),
    label: document.getElementById("archiveLabel"),
    buttons: document.querySelectorAll(".map-btn")
};

function updateMapUI(type) {
    const config = MAP_CONFIG[type];
    if (!config) return;

    // iframeとラベルの更新
    elements.iframe.src = config.url;
    elements.label.textContent = config.label;

    // ボタンの状態更新
    elements.buttons.forEach(btn => {
        const isActive = btn.dataset.type === type;
        if (isActive) {
            btn.classList.add(...STYLES.active);
            btn.classList.remove(...STYLES.inactive);
        } else {
            btn.classList.add(...STYLES.inactive);
            btn.classList.remove(...STYLES.active);
        }
    });
}

// 初期化とイベントリスナーの登録
document.addEventListener("DOMContentLoaded", () => {
    // ボタンクリック時の挙動
    elements.buttons.forEach(btn => {
        btn.addEventListener("click", () => updateMapUI(btn.dataset.type));
    });

    // 初期表示設定 (デフォルト: street)
    updateMapUI("street");
});
</script>

</body>
</html>